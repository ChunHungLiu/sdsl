<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Succinct Data Structure Library (sdsl): sdsl/include/sdsl/algorithms_for_balanced_parentheses.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Succinct Data Structure Library (sdsl)
   
   </div>
   <div id="projectbrief">A C++ template library for succinct data structures</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sdsl/include/sdsl/algorithms_for_balanced_parentheses.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="algorithms__for__balanced__parentheses_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* sdsl - succinct data structures library</span>
<a name="l00002"></a>00002 <span class="comment">    Copyright (C) 2009 Simon Gog </span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">    This program is free software: you can redistribute it and/or modify</span>
<a name="l00005"></a>00005 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00006"></a>00006 <span class="comment">    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00007"></a>00007 <span class="comment">    (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">    This program is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment">    along with this program.  If not, see http://www.gnu.org/licenses/ .</span>
<a name="l00016"></a>00016 <span class="comment">*/</span>
<a name="l00021"></a>00021 <span class="preprocessor">#ifndef INCLUDED_SDSL_ALGORITHMS_FOR_BALANCED_PARENTHESES</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#define INCLUDED_SDSL_ALGORITHMS_FOR_BALANCED_PARENTHESES</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;int_vector.hpp&quot;</span> <span class="comment">// for bit_vector</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stack&gt;</span> <span class="comment">// for calculate_pioneers_bitmap method</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;map&gt;</span>   <span class="comment">// for calculate_pioneers_bitmap method</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="sorted__stack__support_8hpp.html" title="sorted_stack_support.hpp contains a data structure for a stack which contains indices of a random acc...">sorted_stack_support.hpp</a>&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">namespace </span>sdsl{
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="keyword">namespace </span>algorithm{    
<a name="l00033"></a>00033 
<a name="l00035"></a>00035 
<a name="l00043"></a><a class="code" href="namespacesdsl_1_1algorithm.html#aad3d575e4af846500969776005d27db1">00043</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacesdsl_1_1algorithm.html#aad3d575e4af846500969776005d27db1" title="Calculate pioneers as defined in the paper of Geary et al. (CPM 2004)">calculate_pioneers_bitmap</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type block_size, bit_vector &amp;pioneer_bitmap){
<a name="l00044"></a>00044         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00045"></a>00045         pioneer_bitmap.resize(bp.size());      <span class="comment">// resize pioneers bitmap</span>
<a name="l00046"></a>00046         util::set_zero_bits(pioneer_bitmap);  <span class="comment">// initialize bitmap with zeros</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048         std::stack&lt;size_type&gt; opening_parenthesis;
<a name="l00049"></a>00049         size_type blocks = (bp.size()+block_size-1)/block_size;
<a name="l00050"></a>00050         <span class="comment">// calculate positions of findclose and findopen pioneers</span>
<a name="l00051"></a>00051         <span class="keywordflow">for</span>(size_type block_nr = 0; block_nr &lt; blocks; ++block_nr){
<a name="l00052"></a>00052                 std::map&lt;size_type, size_type&gt; block_and_position; <span class="comment">// for find_open and find_close</span>
<a name="l00053"></a>00053                 std::map&lt;size_type, size_type&gt; matching_position;  <span class="comment">// for find_open and find_close</span>
<a name="l00054"></a>00054                 <span class="keywordflow">for</span>(size_type i=0, j=block_nr*block_size; i &lt; block_size and j &lt; bp.size(); ++i, ++j){
<a name="l00055"></a>00055                         <span class="keywordflow">if</span>( bp[j] ){<span class="comment">//opening parenthesis</span>
<a name="l00056"></a>00056                                 opening_parenthesis.push(j);
<a name="l00057"></a>00057                         }
<a name="l00058"></a>00058                         <span class="keywordflow">else</span>{<span class="comment">// closing parenthesis</span>
<a name="l00059"></a>00059                                 size_type position = opening_parenthesis.top();
<a name="l00060"></a>00060                                 size_type blockpos = position/block_size;
<a name="l00061"></a>00061                                 opening_parenthesis.pop();
<a name="l00062"></a>00062                                 block_and_position[blockpos] = position;
<a name="l00063"></a>00063                                 matching_position[blockpos]  = j; <span class="comment">// greatest j is pioneer</span>
<a name="l00064"></a>00064                         }
<a name="l00065"></a>00065                 }
<a name="l00066"></a>00066                 <span class="keywordflow">for</span>(std::map&lt;size_type, size_type&gt;::const_iterator it = block_and_position.begin(), 
<a name="l00067"></a>00067                                                                                                                    end = block_and_position.end(), 
<a name="l00068"></a>00068                                                                                                                    mit = matching_position.begin(); it != end and it-&gt;first != block_nr; ++it, ++mit){
<a name="l00069"></a>00069                         <span class="comment">// opening and closing pioneers are symmetric</span>
<a name="l00070"></a>00070                         pioneer_bitmap[it-&gt;second] = 1;
<a name="l00071"></a>00071                         pioneer_bitmap[mit-&gt;second] = 1;
<a name="l00072"></a>00072                 }
<a name="l00073"></a>00073         }
<a name="l00074"></a>00074         <span class="comment">// assert that the sequence is balanced</span>
<a name="l00075"></a>00075         assert(opening_parenthesis.empty());
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00079"></a>00079 
<a name="l00088"></a>00088 <span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="keywordtype">size_t</span>ype&gt;
<a name="l00089"></a><a class="code" href="namespacesdsl_1_1algorithm.html#acb1eb31bc30f95a024b84b7cc4cad60f">00089</a> <span class="keywordtype">void</span> <a class="code" href="namespacesdsl_1_1algorithm.html#acb1eb31bc30f95a024b84b7cc4cad60f" title="Calculate pioneers as defined in the paper of Geary et al. (CPM 2004) with few extra space...">calculate_pioneers_bitmap_succinct</a>(<span class="keyword">const</span> bit_vector &amp;bp, size_type block_size, bit_vector &amp;pioneer_bitmap){
<a name="l00090"></a>00090         pioneer_bitmap.resize(bp.size());    <span class="comment">// resize pioneers bitmap to the resulting size</span>
<a name="l00091"></a>00091         util::set_zero_bits(pioneer_bitmap); <span class="comment">// initialize bitmap with zeros</span>
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <a class="code" href="classsdsl_1_1sorted__stack__support.html" title="A stack class which contains indices of elements from an random access container and the elements are...">sorted_stack_support</a> opening_parenthesis(bp.size());
<a name="l00094"></a>00094         bit_vector::size_type cur_pioneer_block = 0, last_start = 0, last_j = 0, cur_block=0, first_index_in_block=0;
<a name="l00095"></a>00095         <span class="comment">// calculate positions of findclose and findopen pioneers</span>
<a name="l00096"></a>00096         <span class="keywordflow">for</span>(bit_vector::size_type j=0, new_block=block_size; j &lt; bp.size(); ++j, --new_block){
<a name="l00097"></a>00097                 <span class="keywordflow">if</span>( !(new_block) ){
<a name="l00098"></a>00098                         cur_pioneer_block = j/block_size; 
<a name="l00099"></a>00099                         ++cur_block;
<a name="l00100"></a>00100                         first_index_in_block = j;
<a name="l00101"></a>00101                         new_block = block_size;
<a name="l00102"></a>00102                 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104                 <span class="keywordflow">if</span>( bp[j] ){ <span class="comment">// opening parenthesis</span>
<a name="l00105"></a>00105                         <span class="keywordflow">if</span>( <span class="comment">/*j &lt; bp.size() is not neccecssary as the last parenthesis is always a closing one*/</span>
<a name="l00106"></a>00106                             new_block&gt;1 and !bp[j+1] ){
<a name="l00107"></a>00107                                 ++j; --new_block;
<a name="l00108"></a>00108                                 <span class="keywordflow">continue</span>;
<a name="l00109"></a>00109                         }
<a name="l00110"></a>00110                         opening_parenthesis.<a class="code" href="classsdsl_1_1sorted__stack__support.html#ae5d0c7dcf22d3a340e4e0e53f83467b7">push</a>(j);
<a name="l00111"></a>00111                 }<span class="keywordflow">else</span>{
<a name="l00112"></a>00112                         assert( !opening_parenthesis.empty() );
<a name="l00113"></a>00113                         size_type start = opening_parenthesis.top();
<a name="l00114"></a>00114                         opening_parenthesis.pop();
<a name="l00115"></a>00115                         <span class="keywordflow">if</span>( start &lt; first_index_in_block )
<a name="l00116"></a>00116                         {
<a name="l00117"></a>00117                                 <span class="keywordflow">if</span>( (start/block_size)==cur_pioneer_block  ){
<a name="l00118"></a>00118                                         pioneer_bitmap[last_start] = pioneer_bitmap[last_j] = 0; <span class="comment">// override false pioneer</span>
<a name="l00119"></a>00119                                 }
<a name="l00120"></a>00120                                 pioneer_bitmap[start] = pioneer_bitmap[j] = 1;
<a name="l00121"></a>00121                                 cur_pioneer_block         = start/block_size;
<a name="l00122"></a>00122                                 last_start                        = start;
<a name="l00123"></a>00123                                 last_j                            = j;
<a name="l00124"></a>00124                         }
<a name="l00125"></a>00125                 }
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127         <span class="comment">// assert that the sequence is balanced</span>
<a name="l00128"></a>00128         assert(opening_parenthesis.empty());
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="keywordtype">size_t</span>ype&gt;
<a name="l00133"></a>00133 <span class="keywordtype">void</span> calculate_pioneers_bitmap_succinct2(<span class="keyword">const</span> bit_vector &amp;bp, size_type block_size, bit_vector &amp;pioneer_bitmap){
<a name="l00134"></a>00134         pioneer_bitmap.resize(bp.size());    <span class="comment">// resize pioneers bitmap to the resulting size</span>
<a name="l00135"></a>00135         util::set_zero_bits(pioneer_bitmap); <span class="comment">// initialize bitmap with zeros</span>
<a name="l00136"></a>00136         <span class="keyword">const</span> uint64_t *data = bp.data();
<a name="l00137"></a>00137         bit_vector::size_type cnt=0;
<a name="l00138"></a>00138         <span class="keywordflow">for</span>(bit_vector::size_type i=0; i &lt; bp.size() ; i+=64, ++data){
<a name="l00139"></a>00139                 cnt += <a class="code" href="classsdsl_1_1bit__magic.html#aaf1ee53335cac67bcfaf4653cf54a7ef" title="Counts the number of 1-bits in the 64bit integer x.">bit_magic::b1Cnt</a>(*data); 
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00145"></a>00145 
<a name="l00153"></a>00153 <span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="keywordtype">int</span>_vector&gt;
<a name="l00154"></a><a class="code" href="namespacesdsl_1_1algorithm.html#ab7dd2a643b582a46ef854f91c7b5534a">00154</a> <span class="keywordtype">void</span> <a class="code" href="namespacesdsl_1_1algorithm.html#ab7dd2a643b582a46ef854f91c7b5534a" title="Calculates matches (i.e. find_open for a closing parenthesis and find_close for an opening parenthesi...">calculate_matches</a>(<span class="keyword">const</span> bit_vector &amp;bp, int_vector &amp;matches){
<a name="l00155"></a>00155         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00156"></a>00156         matches = int_vector(bp.size(), 0, <a class="code" href="classsdsl_1_1bit__magic.html#add0a212c8b5f894223c49e95aaa2ae8e" title="Calculates the position of the leftmost 1-bit in the 64bit integer x if it exists.">bit_magic::l1BP</a>(bp.size())+1);
<a name="l00157"></a>00157         std::stack&lt;size_type&gt; opening_parenthesis;
<a name="l00158"></a>00158         <span class="keywordflow">for</span>(size_type i=0; i &lt; bp.size(); ++i){
<a name="l00159"></a>00159                 <span class="keywordflow">if</span>( bp[i] ){<span class="comment">// opening parenthesis</span>
<a name="l00160"></a>00160                         opening_parenthesis.push(i);
<a name="l00161"></a>00161                 }<span class="keywordflow">else</span>{ <span class="comment">// closing parenthesis</span>
<a name="l00162"></a>00162                         assert( !opening_parenthesis.empty() );
<a name="l00163"></a>00163                         size_type position = opening_parenthesis.top();
<a name="l00164"></a>00164                         opening_parenthesis.pop();
<a name="l00165"></a>00165                         matches[i] = position;
<a name="l00166"></a>00166                         assert(matches[i]==position);
<a name="l00167"></a>00167                         matches[position] = i;
<a name="l00168"></a>00168                         assert(matches[position]==i);
<a name="l00169"></a>00169                 }
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171         <span class="comment">// assert that the sequence is balanced</span>
<a name="l00172"></a>00172         assert(opening_parenthesis.empty());
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="keywordtype">int</span>_vector&gt;
<a name="l00176"></a>00176 <span class="keywordtype">void</span> calculate_matches_for_pioneers(<span class="keyword">const</span> bit_vector &amp;bp, <span class="keyword">const</span> bit_vector &amp;pioneer_bitmap, int_vector &amp;matches){
<a name="l00177"></a>00177         assert(pioneer_bitmap.size()==bp.size());
<a name="l00178"></a>00178         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00179"></a>00179         matches = int_vector(pioneer_bitmap.size(), 0, <a class="code" href="classsdsl_1_1bit__magic.html#add0a212c8b5f894223c49e95aaa2ae8e" title="Calculates the position of the leftmost 1-bit in the 64bit integer x if it exists.">bit_magic::l1BP</a>(bp.size())+1);
<a name="l00180"></a>00180         std::stack&lt;size_type&gt; opening_parenthesis;
<a name="l00181"></a>00181         <span class="keywordflow">for</span>(size_type i=0; i &lt; bp.size(); ++i){
<a name="l00182"></a>00182                 <span class="keywordflow">if</span>( pioneer_bitmap[i] ){
<a name="l00183"></a>00183                         <span class="keywordflow">if</span>( bp[i] ){<span class="comment">// opening parenthesis</span>
<a name="l00184"></a>00184                                 opening_parenthesis.push(i);
<a name="l00185"></a>00185                         }<span class="keywordflow">else</span>{ <span class="comment">// closing parenthesis</span>
<a name="l00186"></a>00186                                 assert( !opening_parenthesis.empty() );
<a name="l00187"></a>00187                                 size_type position = opening_parenthesis.top();
<a name="l00188"></a>00188                                 opening_parenthesis.pop();
<a name="l00189"></a>00189                                 matches[i] = position;
<a name="l00190"></a>00190                                 assert(matches[i]==position);
<a name="l00191"></a>00191                                 matches[position] = i;
<a name="l00192"></a>00192                                 assert(matches[position]==i);
<a name="l00193"></a>00193                         }
<a name="l00194"></a>00194                 }
<a name="l00195"></a>00195         }
<a name="l00196"></a>00196         <span class="comment">// assert that the sequence is balanced</span>
<a name="l00197"></a>00197         assert(opening_parenthesis.empty());
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00202"></a>00202 
<a name="l00210"></a>00210 <span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="keywordtype">int</span>_vector&gt;
<a name="l00211"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a1a946037a85f7b270054c1765220c18d">00211</a> <span class="keywordtype">void</span> <a class="code" href="namespacesdsl_1_1algorithm.html#a1a946037a85f7b270054c1765220c18d" title="Calculates enclose answers for a balanced parentheses sequence.">calculate_enclose</a>(<span class="keyword">const</span> bit_vector &amp;bp, int_vector &amp;enclose){
<a name="l00212"></a>00212         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00213"></a>00213         enclose = int_vector(bp.size(), 0, <a class="code" href="classsdsl_1_1bit__magic.html#add0a212c8b5f894223c49e95aaa2ae8e" title="Calculates the position of the leftmost 1-bit in the 64bit integer x if it exists.">bit_magic::l1BP</a>(bp.size())+1);
<a name="l00214"></a>00214         std::stack&lt;size_type&gt; opening_parenthesis;
<a name="l00215"></a>00215         <span class="keywordflow">for</span>(size_type i=0; i &lt; bp.size(); ++i){
<a name="l00216"></a>00216                 <span class="keywordflow">if</span>( bp[i] ){<span class="comment">// opening parenthesis</span>
<a name="l00217"></a>00217                         <span class="keywordflow">if</span>( !opening_parenthesis.empty() ){
<a name="l00218"></a>00218                                 size_type position = opening_parenthesis.top();
<a name="l00219"></a>00219                                 enclose[i] = position;
<a name="l00220"></a>00220                                 assert(enclose[i]==position);
<a name="l00221"></a>00221                         }<span class="keywordflow">else</span>
<a name="l00222"></a>00222                                 enclose[i] = bp.size();
<a name="l00223"></a>00223                         opening_parenthesis.push(i);
<a name="l00224"></a>00224                 }<span class="keywordflow">else</span>{ <span class="comment">// closing parenthesis</span>
<a name="l00225"></a>00225                         size_type position = opening_parenthesis.top();
<a name="l00226"></a>00226                         enclose[i] = position; <span class="comment">// find open answer if i is a closing parenthesis</span>
<a name="l00227"></a>00227                         opening_parenthesis.pop();
<a name="l00228"></a>00228                 }
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230         <span class="comment">// assert that the sequence is balanced</span>
<a name="l00231"></a>00231         assert(opening_parenthesis.empty());
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="keyword">template</span>&lt;<span class="keyword">class</span> bp_support&gt;
<a name="l00235"></a>00235 <span class="keywordtype">bool</span> check_bp_support(<span class="keyword">const</span> bit_vector &amp;bp, bp_support bp_s){
<a name="l00236"></a>00236         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00237"></a>00237         <span class="comment">// check access and select</span>
<a name="l00238"></a>00238         <span class="keywordflow">for</span>(size_type i = 0, excess=0, ones=0; i &lt; bp.size(); ++i){
<a name="l00239"></a>00239                 <span class="keywordflow">if</span>( bp[i] ){
<a name="l00240"></a>00240                         ++excess;
<a name="l00241"></a>00241                         ++ones;
<a name="l00242"></a>00242                         size_type sel = bp_s.select(ones);
<a name="l00243"></a>00243                         <span class="keywordflow">if</span>( sel != i ){
<a name="l00244"></a>00244                                 std::cerr&lt;&lt;<span class="stringliteral">&quot;select operation: i=&quot;</span>&lt;&lt;ones&lt;&lt;<span class="stringliteral">&quot; value=&quot;</span>&lt;&lt;sel&lt;&lt;<span class="stringliteral">&quot; expected=&quot;</span>&lt;&lt;i&lt;&lt;std::endl;
<a name="l00245"></a>00245                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00246"></a>00246                         }
<a name="l00247"></a>00247                 }
<a name="l00248"></a>00248                 <span class="keywordflow">else</span>
<a name="l00249"></a>00249                         --excess;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251                 <span class="keywordflow">if</span>( bp_s.excess(i) != excess ){
<a name="l00252"></a>00252                         std::cerr&lt;&lt;<span class="stringliteral">&quot;excess operation: i=&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; value=&quot;</span>&lt;&lt;bp_s.excess(i)&lt;&lt;<span class="stringliteral">&quot; expected=&quot;</span>&lt;&lt; excess&lt;&lt;std::endl;
<a name="l00253"></a>00253                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00254"></a>00254                 }
<a name="l00255"></a>00255         }
<a name="l00256"></a>00256         <span class="comment">// check find_open and find_close</span>
<a name="l00257"></a>00257         std::stack&lt;size_type&gt; opening_parenthesis;
<a name="l00258"></a>00258         <span class="keywordflow">for</span>(size_type i=0; i &lt; bp.size(); ++i){
<a name="l00259"></a>00259 <span class="comment">//              std::cerr&lt;&lt;bp[i]&lt;&lt;&quot; i=&quot;&lt;&lt;i&lt;&lt;std::endl;</span>
<a name="l00260"></a>00260                 <span class="keywordflow">if</span>( bp[i] ){<span class="comment">// opening parenthesis</span>
<a name="l00261"></a>00261                         opening_parenthesis.push(i);
<a name="l00262"></a>00262                 }<span class="keywordflow">else</span>{ <span class="comment">// closing parenthesis</span>
<a name="l00263"></a>00263                         assert( !opening_parenthesis.empty() );
<a name="l00264"></a>00264                         size_type position = opening_parenthesis.top();
<a name="l00265"></a>00265                         size_type fc = bp_s.find_close(position);
<a name="l00266"></a>00266                         <span class="keywordflow">if</span>(fc != i){
<a name="l00267"></a>00267                                 std::cerr&lt;&lt;<span class="stringliteral">&quot;find_close operation: i=&quot;</span>&lt;&lt;position&lt;&lt;<span class="stringliteral">&quot; value=&quot;</span>&lt;&lt;fc&lt;&lt;<span class="stringliteral">&quot; expected=&quot;</span>&lt;&lt; i &lt;&lt; std::endl;
<a name="l00268"></a>00268                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00269"></a>00269                         }
<a name="l00270"></a>00270                         size_type fo = bp_s.find_open(i);
<a name="l00271"></a>00271                         <span class="keywordflow">if</span>(fo != position){
<a name="l00272"></a>00272                                 std::cerr&lt;&lt;<span class="stringliteral">&quot;find_open operation: i=&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; value=&quot;</span>&lt;&lt;fo&lt;&lt;<span class="stringliteral">&quot; expected=&quot;</span>&lt;&lt; position &lt;&lt; std::endl;
<a name="l00273"></a>00273                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00274"></a>00274                         }
<a name="l00275"></a>00275                         opening_parenthesis.pop();
<a name="l00276"></a>00276                 }
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         <span class="keywordflow">if</span>(!opening_parenthesis.empty()){
<a name="l00279"></a>00279                 std::cerr&lt;&lt;<span class="stringliteral">&quot;balanced parenthese sequence is NOT balanced!&quot;</span> &lt;&lt;std::endl;
<a name="l00280"></a>00280                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282         <span class="comment">// check enclose</span>
<a name="l00283"></a>00283         <span class="keywordflow">for</span>(size_type i=0; i &lt; bp.size(); ++i){
<a name="l00284"></a>00284                 <span class="keywordflow">if</span>( bp[i] ){<span class="comment">// opening parenthesis</span>
<a name="l00285"></a>00285                         size_type ec = bp_s.enclose(i);
<a name="l00286"></a>00286                         size_type position = bp.size();
<a name="l00287"></a>00287                         <span class="keywordflow">if</span>( !opening_parenthesis.empty() ){
<a name="l00288"></a>00288                                 position = opening_parenthesis.top();
<a name="l00289"></a>00289                         }
<a name="l00290"></a>00290                         opening_parenthesis.push(i);
<a name="l00291"></a>00291                         <span class="keywordflow">if</span>( ec != position ){
<a name="l00292"></a>00292                                 std::cerr&lt;&lt;<span class="stringliteral">&quot;encolse operation i=&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; value=&quot;</span>&lt;&lt;ec&lt;&lt;<span class="stringliteral">&quot; expected=&quot;</span> &lt;&lt; position &lt;&lt; std::endl;
<a name="l00293"></a>00293                         }
<a name="l00294"></a>00294                 }<span class="keywordflow">else</span>{ <span class="comment">// closing parenthesis</span>
<a name="l00295"></a>00295                         opening_parenthesis.pop();
<a name="l00296"></a>00296                 }
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00302"></a>00302 
<a name="l00309"></a>00309 <span class="comment">// TODO: implement a fast version using lookup-tables of size 8</span>
<a name="l00310"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a2784d01a7b9c1fa332e1278b246ccc68">00310</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#a2784d01a7b9c1fa332e1278b246ccc68" title="Find the near closing parenthesis if it exists.">near_find_close_naive</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l00311"></a>00311         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00312"></a>00312     size_type opening_parentheses = 1;
<a name="l00313"></a>00313         <span class="keywordflow">for</span>(size_type j=i+1; j &lt; (i/block_size+1)*block_size; ++j)      {
<a name="l00314"></a>00314                 <span class="keywordflow">if</span>(bp[j])
<a name="l00315"></a>00315                         ++opening_parentheses;
<a name="l00316"></a>00316                 <span class="keywordflow">else</span>{
<a name="l00317"></a>00317                         --opening_parentheses;
<a name="l00318"></a>00318                         <span class="keywordflow">if</span>( opening_parentheses == 0 ){
<a name="l00319"></a>00319                                 <span class="keywordflow">return</span> j;
<a name="l00320"></a>00320                         }
<a name="l00321"></a>00321                 }
<a name="l00322"></a>00322         }
<a name="l00323"></a>00323         <span class="keywordflow">return</span> i;
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <span class="keyword">const</span> uint32_t near_find_close_8bits_lookup[256]={
<a name="l00327"></a>00327 1985229328U,2574668850U,2574668848U,2576971348U,2574668816U,2576971348U,2576971344U,2576980342U,
<a name="l00328"></a>00328 2574668304U,2576971346U,2576971344U,2576980342U,2576971280U,2576980342U,2576980336U,2576980377U,
<a name="l00329"></a>00329 2574660112U,2576971314U,2576971312U,2576980342U,2576971280U,2576980342U,2576980336U,2576980377U,
<a name="l00330"></a>00330 2576970256U,2576980338U,2576980336U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00331"></a>00331 2574529040U,2576970802U,2576970800U,2576980340U,2576970768U,2576980340U,2576980336U,2576980377U,
<a name="l00332"></a>00332 2576970256U,2576980338U,2576980336U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00333"></a>00333 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00334"></a>00334 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00335"></a>00335 2572431888U,2576962610U,2576962608U,2576980308U,2576962576U,2576980308U,2576980304U,2576980377U,
<a name="l00336"></a>00336 2576962064U,2576980306U,2576980304U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00337"></a>00337 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00338"></a>00338 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00339"></a>00339 2576626192U,2576978994U,2576978992U,2576980372U,2576978960U,2576980372U,2576980368U,2576980377U,
<a name="l00340"></a>00340 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00341"></a>00341 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00342"></a>00342 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00343"></a>00343 2522100240U,2576766002U,2576766000U,2576979540U,2576765968U,2576979540U,2576979536U,2576980374U,
<a name="l00344"></a>00344 2576765456U,2576979538U,2576979536U,2576980374U,2576979472U,2576980374U,2576980368U,2576980377U,
<a name="l00345"></a>00345 2576757264U,2576979506U,2576979504U,2576980374U,2576979472U,2576980374U,2576980368U,2576980377U,
<a name="l00346"></a>00346 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00347"></a>00347 2576626192U,2576978994U,2576978992U,2576980372U,2576978960U,2576980372U,2576980368U,2576980377U,
<a name="l00348"></a>00348 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00349"></a>00349 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00350"></a>00350 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00351"></a>00351 2572431888U,2576962610U,2576962608U,2576980308U,2576962576U,2576980308U,2576980304U,2576980377U,
<a name="l00352"></a>00352 2576962064U,2576980306U,2576980304U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00353"></a>00353 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00354"></a>00354 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00355"></a>00355 2576626192U,2576978994U,2576978992U,2576980372U,2576978960U,2576980372U,2576980368U,2576980377U,
<a name="l00356"></a>00356 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00357"></a>00357 2576953872U,2576980274U,2576980272U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U,
<a name="l00358"></a>00358 2576978448U,2576980370U,2576980368U,2576980377U,2576980240U,2576980377U,2576980368U,2576980377U
<a name="l00359"></a>00359 };
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="keyword">const</span> uint32_t near_find_open_8bits_lookup[256]={
<a name="l00362"></a>00362 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,
<a name="l00363"></a>00363 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,
<a name="l00364"></a>00364 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,
<a name="l00365"></a>00365 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980369U,2576980225U,
<a name="l00366"></a>00366 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,
<a name="l00367"></a>00367 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980369U,2576980225U,
<a name="l00368"></a>00368 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980369U,2576980225U,
<a name="l00369"></a>00369 2576980371U,2576980371U,2576980371U,2576980227U,2576980259U,2576980259U,2576978211U,2576941347U,
<a name="l00370"></a>00370 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,
<a name="l00371"></a>00371 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980369U,2576980225U,
<a name="l00372"></a>00372 2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980377U,2576980369U,2576980225U,
<a name="l00373"></a>00373 2576980371U,2576980371U,2576980371U,2576980227U,2576980259U,2576980259U,2576978211U,2576941347U,
<a name="l00374"></a>00374 2576980373U,2576980373U,2576980373U,2576980373U,2576980373U,2576980373U,2576980373U,2576980229U,
<a name="l00375"></a>00375 2576980373U,2576980373U,2576980373U,2576980229U,2576980261U,2576980261U,2576978213U,2576941349U,
<a name="l00376"></a>00376 2576980293U,2576980293U,2576980293U,2576980293U,2576980293U,2576980293U,2576978245U,2576941381U,
<a name="l00377"></a>00377 2576978757U,2576978757U,2576978757U,2576941893U,2576950085U,2576950085U,2576425797U,2566988613U,
<a name="l00378"></a>00378 2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,
<a name="l00379"></a>00379 2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980231U,
<a name="l00380"></a>00380 2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980231U,
<a name="l00381"></a>00381 2576980375U,2576980375U,2576980375U,2576980231U,2576980263U,2576980263U,2576978215U,2576941351U,
<a name="l00382"></a>00382 2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980375U,2576980231U,
<a name="l00383"></a>00383 2576980375U,2576980375U,2576980375U,2576980231U,2576980263U,2576980263U,2576978215U,2576941351U,
<a name="l00384"></a>00384 2576980295U,2576980295U,2576980295U,2576980295U,2576980295U,2576980295U,2576978247U,2576941383U,
<a name="l00385"></a>00385 2576978759U,2576978759U,2576978759U,2576941895U,2576950087U,2576950087U,2576425799U,2566988615U,
<a name="l00386"></a>00386 2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,
<a name="l00387"></a>00387 2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576978279U,2576941415U,
<a name="l00388"></a>00388 2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576980327U,2576978279U,2576941415U,
<a name="l00389"></a>00389 2576978791U,2576978791U,2576978791U,2576941927U,2576950119U,2576950119U,2576425831U,2566988647U,
<a name="l00390"></a>00390 2576979303U,2576979303U,2576979303U,2576979303U,2576979303U,2576979303U,2576979303U,2576942439U,
<a name="l00391"></a>00391 2576979303U,2576979303U,2576979303U,2576942439U,2576950631U,2576950631U,2576426343U,2566989159U,
<a name="l00392"></a>00392 2576958823U,2576958823U,2576958823U,2576958823U,2576958823U,2576958823U,2576434535U,2566997351U,
<a name="l00393"></a>00393 2576565607U,2576565607U,2576565607U,2567128423U,2569225575U,2569225575U,2435007847U,19088743U
<a name="l00394"></a>00394 };
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="keyword">const</span> int8_t excess_8bits_lookup[256]={
<a name="l00397"></a>00397 -8,-6,-6,-4,-6,-4,-4,-2,-6,-4,-4,-2,-4,-2,-2,0,
<a name="l00398"></a>00398 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,0,2,
<a name="l00399"></a>00399 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,0,2,
<a name="l00400"></a>00400 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00401"></a>00401 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,0,2,
<a name="l00402"></a>00402 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00403"></a>00403 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00404"></a>00404 -2,0,0,2,0,2,2,4,0,2,2,4,2,4,4,6,
<a name="l00405"></a>00405 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,0,2,
<a name="l00406"></a>00406 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00407"></a>00407 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00408"></a>00408 -2,0,0,2,0,2,2,4,0,2,2,4,2,4,4,6,
<a name="l00409"></a>00409 -4,-2,-2,0,-2,0,0,2,-2,0,0,2,0,2,2,4,
<a name="l00410"></a>00410 -2,0,0,2,0,2,2,4,0,2,2,4,2,4,4,6,
<a name="l00411"></a>00411 -2,0,0,2,0,2,2,4,0,2,2,4,2,4,4,6,
<a name="l00412"></a>00412 0,2,2,4,2,4,4,6,2,4,4,6,4,6,6,8
<a name="l00413"></a>00413 };
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keyword">inline</span> bit_vector::size_type near_find_close(<span class="keyword">const</span> bit_vector &amp;bp, <span class="keyword">const</span> bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l00416"></a>00416         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00417"></a>00417         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l00418"></a>00418         difference_type excess=1;
<a name="l00419"></a>00419         
<a name="l00420"></a>00420         <span class="keyword">const</span> size_type end = ((i+1)/block_size+1)*block_size;
<a name="l00421"></a>00421         <span class="keyword">const</span> size_type l = (((i+1)+7)/8)*8;
<a name="l00422"></a>00422         <span class="keyword">const</span> size_type r = (end/8)*8;
<a name="l00423"></a>00423         <span class="keywordflow">for</span>(size_type j=i+1; j &lt; std::min(end,l); ++j)  {
<a name="l00424"></a>00424                 <span class="keywordflow">if</span>(bp[j])
<a name="l00425"></a>00425                         ++excess;
<a name="l00426"></a>00426                 <span class="keywordflow">else</span>{
<a name="l00427"></a>00427                         --excess;
<a name="l00428"></a>00428                         <span class="keywordflow">if</span>( excess == 0 ){
<a name="l00429"></a>00429                                 <span class="keywordflow">return</span> j;
<a name="l00430"></a>00430                         }
<a name="l00431"></a>00431                 }
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l00434"></a>00434         <span class="keywordflow">for</span>(size_type j=l; j&lt;r; j+=8){
<a name="l00435"></a>00435                 <span class="keywordflow">if</span>( excess &lt;= 8){
<a name="l00436"></a>00436                         assert(excess&gt;0);
<a name="l00437"></a>00437                         uint32_t x = near_find_close_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00438"></a>00438                         uint8_t p = (x &gt;&gt; ((excess-1)&lt;&lt;2))&amp;0xF;
<a name="l00439"></a>00439                     <span class="keywordflow">if</span>( p &lt; 9 ){
<a name="l00440"></a>00440                                 <span class="keywordflow">return</span> j+p;
<a name="l00441"></a>00441                         }       
<a name="l00442"></a>00442                 }
<a name="l00443"></a>00443                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445         <span class="keywordflow">for</span>(size_type j=std::max(l,r); j &lt; end; ++j)    {
<a name="l00446"></a>00446                 <span class="keywordflow">if</span>(bp[j])
<a name="l00447"></a>00447                         ++excess;
<a name="l00448"></a>00448                 <span class="keywordflow">else</span>{
<a name="l00449"></a>00449                         --excess;
<a name="l00450"></a>00450                         <span class="keywordflow">if</span>( excess == 0 ){
<a name="l00451"></a>00451                                 <span class="keywordflow">return</span> j;
<a name="l00452"></a>00452                         }
<a name="l00453"></a>00453                 }
<a name="l00454"></a>00454         }
<a name="l00455"></a>00455         <span class="keywordflow">return</span> i;
<a name="l00456"></a>00456 }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 <span class="comment">// TODO: umbenennen der method in near_find_first_closing_with_excess_diff</span>
<a name="l00459"></a>00459 <span class="keyword">inline</span> bit_vector::size_type near_find_closing(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, bit_vector::size_type closings, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l00460"></a>00460         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00461"></a>00461         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l00462"></a>00462         difference_type excess=0;
<a name="l00463"></a>00463         difference_type succ_excess=-closings;
<a name="l00464"></a>00464         
<a name="l00465"></a>00465         <span class="keyword">const</span> size_type end = (i/block_size+1)*block_size;
<a name="l00466"></a>00466         <span class="keyword">const</span> size_type l = (((i)+7)/8)*8;
<a name="l00467"></a>00467         <span class="keyword">const</span> size_type r = (end/8)*8;
<a name="l00468"></a>00468         <span class="keywordflow">for</span>(size_type j=i; j &lt; std::min(end,l); ++j)    {
<a name="l00469"></a>00469                 <span class="keywordflow">if</span>(bp[j])
<a name="l00470"></a>00470                         ++excess;
<a name="l00471"></a>00471                 <span class="keywordflow">else</span>{
<a name="l00472"></a>00472                         --excess;
<a name="l00473"></a>00473                         <span class="keywordflow">if</span>( excess == succ_excess ){
<a name="l00474"></a>00474                                 <span class="keywordflow">return</span> j;
<a name="l00475"></a>00475                         }
<a name="l00476"></a>00476                 }
<a name="l00477"></a>00477         }
<a name="l00478"></a>00478         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l00479"></a>00479         <span class="keywordflow">for</span>(size_type j=l; j&lt;r; j+=8){
<a name="l00480"></a>00480                 <span class="keywordflow">if</span>( excess-succ_excess &lt;= 8){
<a name="l00481"></a>00481 <span class="comment">//                      assert(excess&gt;0);</span>
<a name="l00482"></a>00482                         uint32_t x = near_find_close_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00483"></a>00483                         uint8_t p = (x &gt;&gt; (((excess-succ_excess)-1)&lt;&lt;2))&amp;0xF;
<a name="l00484"></a>00484                     <span class="keywordflow">if</span>( p &lt; 9 ){
<a name="l00485"></a>00485                                 <span class="keywordflow">return</span> j+p;
<a name="l00486"></a>00486                         }       
<a name="l00487"></a>00487                 }
<a name="l00488"></a>00488                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00489"></a>00489         }
<a name="l00490"></a>00490         <span class="keywordflow">for</span>(size_type j=std::max(l,r); j &lt; end; ++j)    {
<a name="l00491"></a>00491                 <span class="keywordflow">if</span>(bp[j])
<a name="l00492"></a>00492                         ++excess;
<a name="l00493"></a>00493                 <span class="keywordflow">else</span>{
<a name="l00494"></a>00494                         --excess;
<a name="l00495"></a>00495                         <span class="keywordflow">if</span>( excess == succ_excess ){
<a name="l00496"></a>00496                                 <span class="keywordflow">return</span> j;
<a name="l00497"></a>00497                         }
<a name="l00498"></a>00498                 }
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500         <span class="keywordflow">return</span> i-1;
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> near_fwd_excess_8bits_lookup[4352]={
<a name="l00504"></a>00504 7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00505"></a>00505 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00506"></a>00506 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00507"></a>00507 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00508"></a>00508 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00509"></a>00509 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00510"></a>00510 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00511"></a>00511 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00512"></a>00512 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00513"></a>00513 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00514"></a>00514 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00515"></a>00515 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00516"></a>00516 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00517"></a>00517 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00518"></a>00518 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00519"></a>00519 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00522"></a>00522 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00523"></a>00523 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00524"></a>00524 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00525"></a>00525 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00526"></a>00526 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00527"></a>00527 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00528"></a>00528 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00529"></a>00529 6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00530"></a>00530 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00531"></a>00531 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00532"></a>00532 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00533"></a>00533 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00534"></a>00534 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00535"></a>00535 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00536"></a>00536 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 5,7,7,8,7,8,8,8,7,8,8,8,8,8,8,8,
<a name="l00539"></a>00539 7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00540"></a>00540 7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00541"></a>00541 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00542"></a>00542 5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00543"></a>00543 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00544"></a>00544 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00545"></a>00545 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00546"></a>00546 5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00547"></a>00547 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00548"></a>00548 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00549"></a>00549 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00550"></a>00550 5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00551"></a>00551 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00552"></a>00552 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00553"></a>00553 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00554"></a>00554 
<a name="l00555"></a>00555 4,6,6,8,6,8,8,8,6,8,8,8,8,8,8,8,
<a name="l00556"></a>00556 6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00557"></a>00557 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00558"></a>00558 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00559"></a>00559 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00560"></a>00560 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00561"></a>00561 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00562"></a>00562 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00563"></a>00563 4,6,6,8,6,8,8,8,6,8,8,8,8,8,8,8,
<a name="l00564"></a>00564 6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00565"></a>00565 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00566"></a>00566 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00567"></a>00567 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00568"></a>00568 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00569"></a>00569 4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00570"></a>00570 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 3,5,5,7,5,7,7,8,5,7,7,8,7,8,8,8,
<a name="l00573"></a>00573 3,7,7,8,7,8,8,8,7,8,8,8,8,8,8,8,
<a name="l00574"></a>00574 3,7,7,8,7,8,8,8,7,8,8,8,8,8,8,8,
<a name="l00575"></a>00575 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00576"></a>00576 3,5,5,8,5,8,8,8,5,8,8,8,8,8,8,8,
<a name="l00577"></a>00577 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00578"></a>00578 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00579"></a>00579 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00580"></a>00580 3,5,5,8,5,8,8,8,5,8,8,8,8,8,8,8,
<a name="l00581"></a>00581 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00582"></a>00582 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00583"></a>00583 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00584"></a>00584 3,5,5,8,5,8,8,8,5,8,8,8,8,8,8,8,
<a name="l00585"></a>00585 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00586"></a>00586 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00587"></a>00587 3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00588"></a>00588 
<a name="l00589"></a>00589 2,4,4,6,4,6,6,8,2,6,6,8,6,8,8,8,
<a name="l00590"></a>00590 2,6,6,8,6,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00591"></a>00591 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00592"></a>00592 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00593"></a>00593 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00594"></a>00594 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00595"></a>00595 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00596"></a>00596 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00597"></a>00597 2,4,4,6,4,6,6,8,2,6,6,8,6,8,8,8,
<a name="l00598"></a>00598 2,6,6,8,6,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00599"></a>00599 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00600"></a>00600 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00601"></a>00601 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00602"></a>00602 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00603"></a>00603 2,4,4,8,4,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00604"></a>00604 2,8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 1,3,3,5,1,5,5,7,1,5,5,7,1,7,7,8,
<a name="l00607"></a>00607 1,3,3,7,1,7,7,8,1,7,7,8,1,8,8,8,
<a name="l00608"></a>00608 1,3,3,7,1,7,7,8,1,7,7,8,1,8,8,8,
<a name="l00609"></a>00609 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00610"></a>00610 1,3,3,5,1,5,5,8,1,5,5,8,1,8,8,8,
<a name="l00611"></a>00611 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00612"></a>00612 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00613"></a>00613 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00614"></a>00614 1,3,3,5,1,5,5,8,1,5,5,8,1,8,8,8,
<a name="l00615"></a>00615 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00616"></a>00616 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00617"></a>00617 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00618"></a>00618 1,3,3,5,1,5,5,8,1,5,5,8,1,8,8,8,
<a name="l00619"></a>00619 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00620"></a>00620 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00621"></a>00621 1,3,3,8,1,8,8,8,1,8,8,8,1,8,8,8,
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 0,2,0,4,0,4,0,6,0,2,0,6,0,6,0,8,
<a name="l00624"></a>00624 0,2,0,6,0,6,0,8,0,2,0,8,0,8,0,8,
<a name="l00625"></a>00625 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00626"></a>00626 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00627"></a>00627 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00628"></a>00628 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00629"></a>00629 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00630"></a>00630 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00631"></a>00631 0,2,0,4,0,4,0,6,0,2,0,6,0,6,0,8,
<a name="l00632"></a>00632 0,2,0,6,0,6,0,8,0,2,0,8,0,8,0,8,
<a name="l00633"></a>00633 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00634"></a>00634 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00635"></a>00635 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00636"></a>00636 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00637"></a>00637 0,2,0,4,0,4,0,8,0,2,0,8,0,8,0,8,
<a name="l00638"></a>00638 0,2,0,8,0,8,0,8,0,2,0,8,0,8,0,8,
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 8,1,1,3,8,1,1,5,8,1,1,5,3,1,1,7,
<a name="l00641"></a>00641 8,1,1,3,8,1,1,7,8,1,1,7,3,1,1,8,
<a name="l00642"></a>00642 8,1,1,3,8,1,1,7,8,1,1,7,3,1,1,8,
<a name="l00643"></a>00643 8,1,1,3,5,1,1,8,5,1,1,8,3,1,1,8,
<a name="l00644"></a>00644 8,1,1,3,8,1,1,5,8,1,1,5,3,1,1,8,
<a name="l00645"></a>00645 8,1,1,3,8,1,1,8,8,1,1,8,3,1,1,8,
<a name="l00646"></a>00646 8,1,1,3,8,1,1,8,8,1,1,8,3,1,1,8,
<a name="l00647"></a>00647 8,1,1,3,5,1,1,8,5,1,1,8,3,1,1,8,
<a name="l00648"></a>00648 8,1,1,3,8,1,1,5,8,1,1,5,3,1,1,8,
<a name="l00649"></a>00649 8,1,1,3,8,1,1,8,8,1,1,8,3,1,1,8,
<a name="l00650"></a>00650 8,1,1,3,8,1,1,8,8,1,1,8,3,1,1,8,
<a name="l00651"></a>00651 8,1,1,3,5,1,1,8,5,1,1,8,3,1,1,8,
<a name="l00652"></a>00652 8,1,1,3,8,1,1,5,8,1,1,5,3,1,1,8,
<a name="l00653"></a>00653 8,1,1,3,7,1,1,8,7,1,1,8,3,1,1,8,
<a name="l00654"></a>00654 8,1,1,3,7,1,1,8,7,1,1,8,3,1,1,8,
<a name="l00655"></a>00655 7,1,1,3,5,1,1,8,5,1,1,8,3,1,1,8,
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00658"></a>00658 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00659"></a>00659 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00660"></a>00660 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00661"></a>00661 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00662"></a>00662 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00663"></a>00663 8,0,8,0,8,0,2,0,8,0,6,0,6,0,2,0,
<a name="l00664"></a>00664 8,0,6,0,6,0,2,0,6,0,4,0,4,0,2,0,
<a name="l00665"></a>00665 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00666"></a>00666 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00667"></a>00667 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00668"></a>00668 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00669"></a>00669 8,0,8,0,8,0,2,0,8,0,8,0,8,0,2,0,
<a name="l00670"></a>00670 8,0,8,0,8,0,2,0,8,0,4,0,4,0,2,0,
<a name="l00671"></a>00671 8,0,8,0,8,0,2,0,8,0,6,0,6,0,2,0,
<a name="l00672"></a>00672 8,0,6,0,6,0,2,0,6,0,4,0,4,0,2,0,
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00675"></a>00675 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00676"></a>00676 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00677"></a>00677 8,8,8,1,8,5,5,1,8,5,5,1,5,3,3,1,
<a name="l00678"></a>00678 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00679"></a>00679 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00680"></a>00680 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00681"></a>00681 8,8,8,1,8,5,5,1,8,5,5,1,5,3,3,1,
<a name="l00682"></a>00682 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00683"></a>00683 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00684"></a>00684 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00685"></a>00685 8,8,8,1,8,5,5,1,8,5,5,1,5,3,3,1,
<a name="l00686"></a>00686 8,8,8,1,8,8,8,1,8,8,8,1,8,3,3,1,
<a name="l00687"></a>00687 8,8,8,1,8,7,7,1,8,7,7,1,7,3,3,1,
<a name="l00688"></a>00688 8,8,8,1,8,7,7,1,8,7,7,1,7,3,3,1,
<a name="l00689"></a>00689 8,7,7,1,7,5,5,1,7,5,5,1,5,3,3,1,
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00692"></a>00692 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00693"></a>00693 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00694"></a>00694 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00695"></a>00695 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00696"></a>00696 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00697"></a>00697 8,8,8,8,8,8,8,2,8,8,8,6,8,6,6,2,
<a name="l00698"></a>00698 8,8,8,6,8,6,6,2,8,6,6,4,6,4,4,2,
<a name="l00699"></a>00699 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00700"></a>00700 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00701"></a>00701 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00702"></a>00702 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00703"></a>00703 8,8,8,8,8,8,8,2,8,8,8,8,8,8,8,2,
<a name="l00704"></a>00704 8,8,8,8,8,8,8,2,8,8,8,4,8,4,4,2,
<a name="l00705"></a>00705 8,8,8,8,8,8,8,2,8,8,8,6,8,6,6,2,
<a name="l00706"></a>00706 8,8,8,6,8,6,6,2,8,6,6,4,6,4,4,2,
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00709"></a>00709 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00710"></a>00710 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00711"></a>00711 8,8,8,8,8,8,8,5,8,8,8,5,8,5,5,3,
<a name="l00712"></a>00712 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00713"></a>00713 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00714"></a>00714 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00715"></a>00715 8,8,8,8,8,8,8,5,8,8,8,5,8,5,5,3,
<a name="l00716"></a>00716 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00717"></a>00717 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00718"></a>00718 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00719"></a>00719 8,8,8,8,8,8,8,5,8,8,8,5,8,5,5,3,
<a name="l00720"></a>00720 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,3,
<a name="l00721"></a>00721 8,8,8,8,8,8,8,7,8,8,8,7,8,7,7,3,
<a name="l00722"></a>00722 8,8,8,8,8,8,8,7,8,8,8,7,8,7,7,3,
<a name="l00723"></a>00723 8,8,8,7,8,7,7,5,8,7,7,5,7,5,5,3,
<a name="l00724"></a>00724 
<a name="l00725"></a>00725 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00726"></a>00726 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00727"></a>00727 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00728"></a>00728 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00729"></a>00729 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00730"></a>00730 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00731"></a>00731 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,
<a name="l00732"></a>00732 8,8,8,8,8,8,8,6,8,8,8,6,8,6,6,4,
<a name="l00733"></a>00733 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00734"></a>00734 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00735"></a>00735 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00736"></a>00736 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00737"></a>00737 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00738"></a>00738 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,
<a name="l00739"></a>00739 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,
<a name="l00740"></a>00740 8,8,8,8,8,8,8,6,8,8,8,6,8,6,6,4,
<a name="l00741"></a>00741 
<a name="l00742"></a>00742 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00743"></a>00743 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00744"></a>00744 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00745"></a>00745 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,5,
<a name="l00746"></a>00746 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00747"></a>00747 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00748"></a>00748 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00749"></a>00749 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,5,
<a name="l00750"></a>00750 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00751"></a>00751 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00752"></a>00752 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00753"></a>00753 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,5,
<a name="l00754"></a>00754 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00755"></a>00755 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,
<a name="l00756"></a>00756 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,
<a name="l00757"></a>00757 8,8,8,8,8,8,8,7,8,8,8,7,8,7,7,5,
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00760"></a>00760 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00761"></a>00761 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00762"></a>00762 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00763"></a>00763 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00764"></a>00764 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00765"></a>00765 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00766"></a>00766 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,
<a name="l00767"></a>00767 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00768"></a>00768 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00769"></a>00769 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00770"></a>00770 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00771"></a>00771 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00772"></a>00772 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00773"></a>00773 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00774"></a>00774 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00777"></a>00777 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00778"></a>00778 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00779"></a>00779 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00780"></a>00780 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00781"></a>00781 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00782"></a>00782 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00783"></a>00783 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00784"></a>00784 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00785"></a>00785 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00786"></a>00786 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00787"></a>00787 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00788"></a>00788 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00789"></a>00789 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00790"></a>00790 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00791"></a>00791 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7
<a name="l00792"></a>00792 };
<a name="l00793"></a>00793 
<a name="l00795"></a>00795 
<a name="l00797"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a772cc32d6b1183bc7879d1e399c9758e">00797</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#a772cc32d6b1183bc7879d1e399c9758e" title="This method searches the minimal parenthesis j, with j&gt;=i, such that excess(j) = excess(i-1)+rel.">near_fwd_excess</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, bit_vector::difference_type rel, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l00798"></a>00798         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00799"></a>00799         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l00800"></a>00800         difference_type excess = rel;
<a name="l00801"></a>00801 <span class="comment">//      std::cout&lt;&lt;&quot;excess =  &quot;&lt;&lt;excess&lt;&lt;std::endl;</span>
<a name="l00802"></a>00802         
<a name="l00803"></a>00803         <span class="keyword">const</span> size_type end = (i/block_size+1)*block_size;
<a name="l00804"></a>00804         <span class="keyword">const</span> size_type l = (((i)+7)/8)*8;
<a name="l00805"></a>00805         <span class="keyword">const</span> size_type r = (end/8)*8;
<a name="l00806"></a>00806         <span class="keywordflow">for</span>(size_type j=i; j &lt; std::min(end,l); ++j){
<a name="l00807"></a>00807                 <span class="keywordflow">if</span>(bp[j])
<a name="l00808"></a>00808                         --excess;
<a name="l00809"></a>00809                 <span class="keywordflow">else</span>{
<a name="l00810"></a>00810                         ++excess;
<a name="l00811"></a>00811                 }
<a name="l00812"></a>00812                 <span class="keywordflow">if</span>( !excess ){ <span class="keywordflow">return</span> j; }
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814         excess += 8;
<a name="l00815"></a>00815         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l00816"></a>00816         <span class="keywordflow">for</span>(size_type j=l; j &lt; r; j+=8){
<a name="l00817"></a>00817                 <span class="keywordflow">if</span>( excess &gt;= 0 and  excess &lt;= 16){
<a name="l00818"></a>00818                         uint32_t x = near_fwd_excess_8bits_lookup[ (excess&lt;&lt;8) + (((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF) ];
<a name="l00819"></a>00819                     <span class="keywordflow">if</span>( x &lt; 8 ){
<a name="l00820"></a>00820                                 <span class="keywordflow">return</span> j+x;
<a name="l00821"></a>00821                         }
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823                 excess -= excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00824"></a>00824         }
<a name="l00825"></a>00825         excess -= 8;
<a name="l00826"></a>00826         <span class="keywordflow">for</span>(size_type j=std::max(l,r); j &lt; end; ++j){
<a name="l00827"></a>00827                 <span class="keywordflow">if</span>(bp[j])
<a name="l00828"></a>00828                         --excess;
<a name="l00829"></a>00829                 <span class="keywordflow">else</span>{
<a name="l00830"></a>00830                         ++excess;
<a name="l00831"></a>00831                 }
<a name="l00832"></a>00832                 <span class="keywordflow">if</span>( !excess ){ <span class="keywordflow">return</span> j; }
<a name="l00833"></a>00833         }
<a name="l00834"></a>00834         <span class="keywordflow">return</span> i-1;
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 <span class="keyword">const</span> int8_t near_rmq_8bits_val_lookup[256]={
<a name="l00838"></a>00838 -8,-6,-6,-4,-6,-4,-4,-2,-6,-4,-4,-2,-4,-2,-2,0,
<a name="l00839"></a>00839 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,-1,1,
<a name="l00840"></a>00840 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,-1,1,
<a name="l00841"></a>00841 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00842"></a>00842 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,-1,1,
<a name="l00843"></a>00843 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00844"></a>00844 -5,-3,-3,-1,-3,-1,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00845"></a>00845 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00846"></a>00846 -7,-5,-5,-3,-5,-3,-3,-1,-5,-3,-3,-1,-3,-1,-1,1,
<a name="l00847"></a>00847 -5,-3,-3,-1,-3,-1,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00848"></a>00848 -5,-3,-3,-1,-3,-1,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00849"></a>00849 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00850"></a>00850 -6,-4,-4,-2,-4,-2,-2,0,-4,-2,-2,0,-2,0,-1,1,
<a name="l00851"></a>00851 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00852"></a>00852 -5,-3,-3,-1,-3,-1,-1,1,-3,-1,-1,1,-2,0,-1,1,
<a name="l00853"></a>00853 -4,-2,-2,0,-2,0,-1,1,-3,-1,-1,1,-2,0,-1,1
<a name="l00854"></a>00854 };
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 <span class="keyword">const</span> int8_t near_rightmost_rmq_8bits_pos_lookup[256]={
<a name="l00857"></a>00857 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l00858"></a>00858 7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,
<a name="l00859"></a>00859 7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,
<a name="l00860"></a>00860 7,7,7,7,7,7,0,0,2,2,2,2,1,1,0,0,
<a name="l00861"></a>00861 7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,
<a name="l00862"></a>00862 7,7,7,7,7,7,0,0,2,2,2,2,1,1,0,0,
<a name="l00863"></a>00863 4,4,4,4,4,4,4,4,4,4,4,4,1,1,0,0,
<a name="l00864"></a>00864 3,3,3,3,3,3,0,0,2,2,2,2,1,1,0,0,
<a name="l00865"></a>00865 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l00866"></a>00866 6,6,6,6,6,6,6,6,6,6,6,6,1,1,0,0,
<a name="l00867"></a>00867 6,6,6,6,6,6,6,6,6,6,6,6,1,1,0,0,
<a name="l00868"></a>00868 3,3,3,3,3,3,0,0,2,2,2,2,1,1,0,0,
<a name="l00869"></a>00869 5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,
<a name="l00870"></a>00870 5,5,5,5,5,5,0,0,2,2,2,2,1,1,0,0,
<a name="l00871"></a>00871 4,4,4,4,4,4,4,4,4,4,4,4,1,1,0,0,
<a name="l00872"></a>00872 3,3,3,3,3,3,0,0,2,2,2,2,1,1,0,0
<a name="l00873"></a>00873 };
<a name="l00874"></a>00874 
<a name="l00876"></a>00876 
<a name="l00881"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a1330e14ac6487679fc85942a188d8e34">00881</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#a1330e14ac6487679fc85942a188d8e34" title="Calculate the position with minimal excess value in the interval [l..r].">near_rmq</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type l, bit_vector::size_type r, bit_vector::difference_type &amp;min_rel_ex){
<a name="l00882"></a>00882         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l00883"></a>00883         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l00884"></a>00884         <span class="keyword">const</span> size_type l8 = (((l+1)+7)/8)*8;
<a name="l00885"></a>00885         <span class="keyword">const</span> size_type r8 = (r/8)*8;
<a name="l00886"></a>00886         difference_type excess = 0;
<a name="l00887"></a>00887         difference_type min_pos=l;
<a name="l00888"></a>00888         min_rel_ex = 0;
<a name="l00889"></a>00889         <span class="keywordflow">for</span>(size_type j=l+1; j &lt; std::min(l8,r+1); ++j){
<a name="l00890"></a>00890                 <span class="keywordflow">if</span>(bp[j])
<a name="l00891"></a>00891                         ++excess;
<a name="l00892"></a>00892                 <span class="keywordflow">else</span>{
<a name="l00893"></a>00893                         --excess;
<a name="l00894"></a>00894                         <span class="keywordflow">if</span>( excess &lt;= min_rel_ex ){
<a name="l00895"></a>00895                                 min_rel_ex  = excess;
<a name="l00896"></a>00896                                 min_pos         = j;
<a name="l00897"></a>00897                         }
<a name="l00898"></a>00898                 }
<a name="l00899"></a>00899         }
<a name="l00900"></a>00900         
<a name="l00901"></a>00901         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l00902"></a>00902         <span class="keywordflow">for</span>(size_type j=l8; j &lt; r8; j+=8){
<a name="l00903"></a>00903 <span class="comment">//              if( excess-8 &lt;= min_rel_ex ){</span>
<a name="l00904"></a>00904                         int8_t x = near_rmq_8bits_val_lookup[ (((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF) ];
<a name="l00905"></a>00905                         <span class="keywordflow">if</span>( (excess+x) &lt;= min_rel_ex ){
<a name="l00906"></a>00906                                 min_rel_ex = excess+x;
<a name="l00907"></a>00907                                 min_pos    = j + near_rightmost_rmq_8bits_pos_lookup[ (((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF) ];
<a name="l00908"></a>00908                         }
<a name="l00909"></a>00909 <span class="comment">//              }</span>
<a name="l00910"></a>00910                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l00911"></a>00911         }
<a name="l00912"></a>00912         <span class="keywordflow">for</span>(size_type j=std::max(l8,r8); j&lt;r+1; ++j){
<a name="l00913"></a>00913                 <span class="keywordflow">if</span>(bp[j])
<a name="l00914"></a>00914                         ++excess;
<a name="l00915"></a>00915                 <span class="keywordflow">else</span>{
<a name="l00916"></a>00916                         --excess;
<a name="l00917"></a>00917                         <span class="keywordflow">if</span>( excess &lt;= min_rel_ex ){
<a name="l00918"></a>00918                                 min_rel_ex  = excess;
<a name="l00919"></a>00919                                 min_pos         = j;
<a name="l00920"></a>00920                         }
<a name="l00921"></a>00921                 }
<a name="l00922"></a>00922         }
<a name="l00923"></a>00923         <span class="keywordflow">return</span> min_pos;
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> near_bwd_excess_8bits_lookup[4352]={
<a name="l00927"></a>00927 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00928"></a>00928 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00929"></a>00929 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00930"></a>00930 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00931"></a>00931 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00932"></a>00932 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00933"></a>00933 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00934"></a>00934 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00935"></a>00935 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00936"></a>00936 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00937"></a>00937 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00938"></a>00938 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00939"></a>00939 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00940"></a>00940 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00941"></a>00941 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00942"></a>00942 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00943"></a>00943 
<a name="l00944"></a>00944 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00945"></a>00945 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00946"></a>00946 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00947"></a>00947 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00948"></a>00948 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00949"></a>00949 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00950"></a>00950 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00951"></a>00951 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00952"></a>00952 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00953"></a>00953 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00954"></a>00954 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00955"></a>00955 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00956"></a>00956 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00957"></a>00957 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00958"></a>00958 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00959"></a>00959 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l00960"></a>00960 
<a name="l00961"></a>00961 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00962"></a>00962 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00963"></a>00963 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00964"></a>00964 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00965"></a>00965 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00966"></a>00966 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00967"></a>00967 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00968"></a>00968 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00969"></a>00969 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00970"></a>00970 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00971"></a>00971 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00972"></a>00972 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00973"></a>00973 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00974"></a>00974 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00975"></a>00975 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00976"></a>00976 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00979"></a>00979 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00980"></a>00980 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00981"></a>00981 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00982"></a>00982 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00983"></a>00983 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00984"></a>00984 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00985"></a>00985 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l00986"></a>00986 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00987"></a>00987 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00988"></a>00988 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00989"></a>00989 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l00990"></a>00990 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00991"></a>00991 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l00992"></a>00992 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l00993"></a>00993 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l00994"></a>00994 
<a name="l00995"></a>00995 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00996"></a>00996 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00997"></a>00997 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l00998"></a>00998 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l00999"></a>00999 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01000"></a>01000 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01001"></a>01001 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01002"></a>01002 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01003"></a>01003 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01004"></a>01004 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01005"></a>01005 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01006"></a>01006 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01007"></a>01007 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01008"></a>01008 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01009"></a>01009 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01010"></a>01010 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01013"></a>01013 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01014"></a>01014 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01015"></a>01015 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01016"></a>01016 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01017"></a>01017 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01018"></a>01018 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01019"></a>01019 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l01020"></a>01020 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01021"></a>01021 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01022"></a>01022 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01023"></a>01023 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l01024"></a>01024 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01025"></a>01025 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l01026"></a>01026 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01027"></a>01027 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01028"></a>01028 
<a name="l01029"></a>01029 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01030"></a>01030 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01031"></a>01031 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01032"></a>01032 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01033"></a>01033 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01034"></a>01034 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01035"></a>01035 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01036"></a>01036 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01037"></a>01037 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01038"></a>01038 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01039"></a>01039 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01040"></a>01040 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01041"></a>01041 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01042"></a>01042 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01043"></a>01043 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01044"></a>01044 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01045"></a>01045 
<a name="l01046"></a>01046 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01047"></a>01047 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01048"></a>01048 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01049"></a>01049 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l01050"></a>01050 8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,
<a name="l01051"></a>01051 8,8,8,8,8,8,1,1,3,3,3,3,3,3,3,3,
<a name="l01052"></a>01052 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01053"></a>01053 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01054"></a>01054 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01055"></a>01055 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01056"></a>01056 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01057"></a>01057 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01058"></a>01058 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01059"></a>01059 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01060"></a>01060 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01061"></a>01061 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01062"></a>01062 
<a name="l01063"></a>01063 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,
<a name="l01064"></a>01064 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01065"></a>01065 8,8,8,8,8,8,8,0,8,8,8,0,2,2,2,2,
<a name="l01066"></a>01066 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01067"></a>01067 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01068"></a>01068 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01069"></a>01069 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01070"></a>01070 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01071"></a>01071 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01072"></a>01072 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01073"></a>01073 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01074"></a>01074 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01075"></a>01075 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01076"></a>01076 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01077"></a>01077 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01078"></a>01078 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01079"></a>01079 
<a name="l01080"></a>01080 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01081"></a>01081 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01082"></a>01082 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01083"></a>01083 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01084"></a>01084 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01085"></a>01085 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01086"></a>01086 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01087"></a>01087 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
<a name="l01088"></a>01088 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01089"></a>01089 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01090"></a>01090 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01091"></a>01091 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01092"></a>01092 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01093"></a>01093 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01094"></a>01094 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01095"></a>01095 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01096"></a>01096 
<a name="l01097"></a>01097 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01098"></a>01098 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01099"></a>01099 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01100"></a>01100 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
<a name="l01101"></a>01101 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01102"></a>01102 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01103"></a>01103 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01104"></a>01104 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01105"></a>01105 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01106"></a>01106 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01107"></a>01107 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01108"></a>01108 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01109"></a>01109 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01110"></a>01110 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01111"></a>01111 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01112"></a>01112 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01115"></a>01115 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
<a name="l01116"></a>01116 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01117"></a>01117 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01118"></a>01118 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01119"></a>01119 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01120"></a>01120 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01121"></a>01121 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01122"></a>01122 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01123"></a>01123 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01124"></a>01124 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01125"></a>01125 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01126"></a>01126 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01127"></a>01127 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01128"></a>01128 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01129"></a>01129 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
<a name="l01132"></a>01132 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01133"></a>01133 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01134"></a>01134 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01135"></a>01135 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01136"></a>01136 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01137"></a>01137 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01138"></a>01138 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01139"></a>01139 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01140"></a>01140 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01141"></a>01141 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01142"></a>01142 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01143"></a>01143 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01144"></a>01144 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01145"></a>01145 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01146"></a>01146 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01147"></a>01147 
<a name="l01148"></a>01148 3,3,3,3,3,3,3,3,1,1,8,8,8,8,8,8,
<a name="l01149"></a>01149 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01150"></a>01150 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01151"></a>01151 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01152"></a>01152 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01153"></a>01153 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01154"></a>01154 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01155"></a>01155 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01156"></a>01156 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01157"></a>01157 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01158"></a>01158 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01159"></a>01159 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01160"></a>01160 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01161"></a>01161 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01162"></a>01162 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01163"></a>01163 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 2,2,2,2,0,8,8,8,0,8,8,8,8,8,8,8,
<a name="l01166"></a>01166 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01167"></a>01167 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01168"></a>01168 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01169"></a>01169 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01170"></a>01170 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01171"></a>01171 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01172"></a>01172 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01173"></a>01173 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01174"></a>01174 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01175"></a>01175 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01176"></a>01176 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01177"></a>01177 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01178"></a>01178 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01179"></a>01179 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01180"></a>01180 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01183"></a>01183 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01184"></a>01184 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01185"></a>01185 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01186"></a>01186 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01187"></a>01187 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01188"></a>01188 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01189"></a>01189 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01190"></a>01190 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01191"></a>01191 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01192"></a>01192 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01193"></a>01193 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01194"></a>01194 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01195"></a>01195 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01196"></a>01196 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01197"></a>01197 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01198"></a>01198 
<a name="l01199"></a>01199 0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01200"></a>01200 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01201"></a>01201 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01202"></a>01202 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01203"></a>01203 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01204"></a>01204 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01205"></a>01205 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01206"></a>01206 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01207"></a>01207 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01208"></a>01208 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01209"></a>01209 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01210"></a>01210 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01211"></a>01211 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01212"></a>01212 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01213"></a>01213 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
<a name="l01214"></a>01214 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 };
<a name="l01218"></a>01218 
<a name="l01220"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a1d6c53e2e8f22a71de82750d8f472cb2">01220</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#a1d6c53e2e8f22a71de82750d8f472cb2" title="This method searches the maximal parenthesis j, with , such that  and.">near_bwd_excess</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, bit_vector::difference_type rel, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l01221"></a>01221         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01222"></a>01222         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l01223"></a>01223     difference_type excess = rel;
<a name="l01224"></a>01224         <span class="keyword">const</span> difference_type begin = ((difference_type)(i)/block_size)*block_size;
<a name="l01225"></a>01225         <span class="keyword">const</span> difference_type r = ((difference_type)(i)/8)*8;
<a name="l01226"></a>01226         <span class="keyword">const</span> difference_type l = ((difference_type)((begin+7)/8))*8;
<a name="l01227"></a>01227         <span class="keywordflow">for</span>(difference_type j=i+1; j &gt;= <span class="comment">/*begin*/</span>std::max(r,begin); --j){
<a name="l01228"></a>01228                 <span class="keywordflow">if</span>(bp[j])
<a name="l01229"></a>01229                         ++excess;
<a name="l01230"></a>01230                 <span class="keywordflow">else</span>
<a name="l01231"></a>01231                         --excess;
<a name="l01232"></a>01232                 <span class="keywordflow">if</span>( !excess ) <span class="keywordflow">return</span> j-1;
<a name="l01233"></a>01233         }
<a name="l01234"></a>01234         
<a name="l01235"></a>01235         excess += 8;
<a name="l01236"></a>01236         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l01237"></a>01237         <span class="keywordflow">for</span>(difference_type j=r-8; j &gt;= l; j-=8){
<a name="l01238"></a>01238                 <span class="keywordflow">if</span>( excess &gt;= 0 and  excess &lt;= 16){
<a name="l01239"></a>01239                         uint32_t x = near_bwd_excess_8bits_lookup[ (excess&lt;&lt;8) + (((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF) ];
<a name="l01240"></a>01240 <span class="comment">//                      std::cerr&lt;&lt;&quot;i = &quot;&lt;&lt;i&lt;&lt;&quot; j=&quot;&lt;&lt;j&lt;&lt;&quot; x = &quot;&lt;&lt;x&lt;&lt;&quot; excess = &quot;&lt;&lt; excess-8  &lt;&lt; &quot; &quot;&lt;&lt; (((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF) &lt;&lt; &quot; &quot; &lt;&lt; (excess&lt;&lt;8) &lt;&lt; &quot; begin = &quot; &lt;&lt; begin &lt;&lt; &quot; r = &quot; &lt;&lt; r &lt;&lt;&quot; l=&quot;&lt;&lt;l&lt;&lt; std::endl;</span>
<a name="l01241"></a>01241                     <span class="keywordflow">if</span>( x &lt; 8 ){
<a name="l01242"></a>01242                                 <span class="keywordflow">return</span> j+x-1;
<a name="l01243"></a>01243                         }       
<a name="l01244"></a>01244                 }
<a name="l01245"></a>01245                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l01246"></a>01246         }
<a name="l01247"></a>01247         excess -= 8;
<a name="l01248"></a>01248         <span class="keywordflow">for</span>(difference_type j=std::min(l, r); j &gt; begin; --j){
<a name="l01249"></a>01249                 <span class="keywordflow">if</span>(bp[j])
<a name="l01250"></a>01250                         ++excess;
<a name="l01251"></a>01251                 <span class="keywordflow">else</span>
<a name="l01252"></a>01252                         --excess;
<a name="l01253"></a>01253                 <span class="keywordflow">if</span>( !excess ) <span class="keywordflow">return</span> j-1;
<a name="l01254"></a>01254         }
<a name="l01255"></a>01255         <span class="keywordflow">if</span>(0==begin and -1==rel){
<a name="l01256"></a>01256                 <span class="keywordflow">return</span> -1;
<a name="l01257"></a>01257         }
<a name="l01258"></a>01258         <span class="keywordflow">return</span> i+1;
<a name="l01259"></a>01259 }
<a name="l01260"></a>01260 
<a name="l01261"></a>01261 
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 
<a name="l01265"></a>01265 
<a name="l01272"></a><a class="code" href="namespacesdsl_1_1algorithm.html#aa17028f3a5eec3834f1d1b86415eb48f">01272</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#aa17028f3a5eec3834f1d1b86415eb48f" title="Find the near opening parenthesis if it exists.">near_find_open_naive</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l01273"></a>01273         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01274"></a>01274     size_type closing_parentheses = 1;
<a name="l01275"></a>01275         <span class="keywordflow">for</span>(size_type j=i; j+block_size-1 &gt; i and j&gt;0; --j)     {
<a name="l01276"></a>01276                 <span class="keywordflow">if</span>(bp[j-1]){
<a name="l01277"></a>01277                         --closing_parentheses;
<a name="l01278"></a>01278                         <span class="keywordflow">if</span>( closing_parentheses == 0 ){
<a name="l01279"></a>01279                                 <span class="keywordflow">return</span> j-1;
<a name="l01280"></a>01280                         }
<a name="l01281"></a>01281                 }
<a name="l01282"></a>01282                 <span class="keywordflow">else</span>
<a name="l01283"></a>01283                         ++closing_parentheses;
<a name="l01284"></a>01284         }
<a name="l01285"></a>01285         <span class="keywordflow">return</span> i;
<a name="l01286"></a>01286 }
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 
<a name="l01289"></a>01289 <span class="keyword">inline</span> bit_vector::size_type near_find_open(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l01290"></a>01290         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01291"></a>01291         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l01292"></a>01292     difference_type excess = -1;
<a name="l01293"></a>01293         <span class="keyword">const</span> difference_type begin = ((difference_type)(i-1)/block_size)*block_size;
<a name="l01294"></a>01294         <span class="keyword">const</span> difference_type r = ((difference_type)(i-1)/8)*8;
<a name="l01295"></a>01295         <span class="keyword">const</span> difference_type l = ((difference_type)((begin+7)/8))*8;
<a name="l01296"></a>01296         <span class="keywordflow">for</span>(difference_type j=i-1; j &gt;= std::max(r,begin); --j){
<a name="l01297"></a>01297                 <span class="keywordflow">if</span>(bp[j]){
<a name="l01298"></a>01298                         <span class="keywordflow">if</span>( ++excess == 0 ){
<a name="l01299"></a>01299                                 <span class="keywordflow">return</span> j;
<a name="l01300"></a>01300                         }
<a name="l01301"></a>01301                 }
<a name="l01302"></a>01302                 <span class="keywordflow">else</span>
<a name="l01303"></a>01303                         --excess;
<a name="l01304"></a>01304         }
<a name="l01305"></a>01305         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l01306"></a>01306         <span class="keywordflow">for</span>(difference_type j=r-8; j &gt;= l; j-=8){
<a name="l01307"></a>01307                 <span class="keywordflow">if</span>( excess &gt;= -8){
<a name="l01308"></a>01308                         assert(excess&lt;0);
<a name="l01309"></a>01309                         uint32_t x = near_find_open_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l01310"></a>01310                         uint8_t p = (x &gt;&gt; ((-excess-1)&lt;&lt;2))&amp;0xF;
<a name="l01311"></a>01311                     <span class="keywordflow">if</span>( p &lt; 9 ){
<a name="l01312"></a>01312                                 <span class="keywordflow">return</span> j+p;
<a name="l01313"></a>01313                         }       
<a name="l01314"></a>01314                 }
<a name="l01315"></a>01315                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l01316"></a>01316         }
<a name="l01317"></a>01317         <span class="keywordflow">for</span>(difference_type j=std::min(l, r)-1; j &gt;= begin; --j){
<a name="l01318"></a>01318                 <span class="keywordflow">if</span>(bp[j]){
<a name="l01319"></a>01319                         <span class="keywordflow">if</span>( ++excess == 0 ){
<a name="l01320"></a>01320                                 <span class="keywordflow">return</span> j;
<a name="l01321"></a>01321                         }
<a name="l01322"></a>01322                 }
<a name="l01323"></a>01323                 <span class="keywordflow">else</span>
<a name="l01324"></a>01324                         --excess;
<a name="l01325"></a>01325         }
<a name="l01326"></a>01326         <span class="keywordflow">return</span> i;
<a name="l01327"></a>01327 }
<a name="l01328"></a>01328 
<a name="l01329"></a>01329 
<a name="l01330"></a>01330 <span class="keyword">inline</span> bit_vector::size_type near_find_opening(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type openings,<span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l01331"></a>01331         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01332"></a>01332         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l01333"></a>01333     difference_type excess = 0;
<a name="l01334"></a>01334         difference_type succ_excess = openings;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336         <span class="keyword">const</span> difference_type begin = ((difference_type)(i)/block_size)*block_size;
<a name="l01337"></a>01337         <span class="keyword">const</span> difference_type r = ((difference_type)(i)/8)*8;
<a name="l01338"></a>01338         <span class="keyword">const</span> difference_type l = ((difference_type)((begin+7)/8))*8;
<a name="l01339"></a>01339 <span class="comment">//std::cout&lt;&lt;&quot;i=&quot;&lt;&lt;i&lt;&lt;&quot; begin=&quot;&lt;&lt;begin&lt;&lt;&quot; r=&quot;&lt;&lt;r&lt;&lt;&quot; l=&quot;&lt;&lt;l&lt;&lt;std::endl;  </span>
<a name="l01340"></a>01340         <span class="keywordflow">for</span>(difference_type j=i; j &gt;= std::max(r,begin); --j){
<a name="l01341"></a>01341                 <span class="keywordflow">if</span>(bp[j]){
<a name="l01342"></a>01342                         <span class="keywordflow">if</span>( ++excess == succ_excess ){
<a name="l01343"></a>01343                                 <span class="keywordflow">return</span> j;
<a name="l01344"></a>01344                         }
<a name="l01345"></a>01345                 }
<a name="l01346"></a>01346                 <span class="keywordflow">else</span>
<a name="l01347"></a>01347                         --excess;
<a name="l01348"></a>01348         }
<a name="l01349"></a>01349         <span class="keyword">const</span> uint64_t *b = bp.data();
<a name="l01350"></a>01350         <span class="keywordflow">for</span>(difference_type j=r-8; j &gt;= l; j-=8){
<a name="l01351"></a>01351                 <span class="keywordflow">if</span>( succ_excess-excess &lt;= 8){
<a name="l01352"></a>01352 <span class="comment">//                      assert(excess&lt;0);</span>
<a name="l01353"></a>01353                         assert(succ_excess-excess&gt;0);
<a name="l01354"></a>01354                         uint32_t x = near_find_open_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l01355"></a>01355                         uint8_t p = (x &gt;&gt; ((succ_excess-excess-1)&lt;&lt;2))&amp;0xF;
<a name="l01356"></a>01356                     <span class="keywordflow">if</span>( p &lt; 9 ){
<a name="l01357"></a>01357                                 <span class="keywordflow">return</span> j+p;
<a name="l01358"></a>01358                         }       
<a name="l01359"></a>01359                 }
<a name="l01360"></a>01360                 excess += excess_8bits_lookup[ ((*(b+(j&gt;&gt;6)))&gt;&gt;(j&amp;0x3F))&amp;0xFF ];
<a name="l01361"></a>01361         }
<a name="l01362"></a>01362         <span class="keywordflow">for</span>(difference_type j=std::min(l, r)-1; j &gt;= begin; --j){
<a name="l01363"></a>01363                 <span class="keywordflow">if</span>(bp[j]){
<a name="l01364"></a>01364                         <span class="keywordflow">if</span>( ++excess == succ_excess ){
<a name="l01365"></a>01365                                 <span class="keywordflow">return</span> j;
<a name="l01366"></a>01366                         }
<a name="l01367"></a>01367                 }
<a name="l01368"></a>01368                 <span class="keywordflow">else</span>
<a name="l01369"></a>01369                         --excess;
<a name="l01370"></a>01370         }
<a name="l01371"></a>01371         <span class="keywordflow">return</span> i+1;
<a name="l01372"></a>01372 }
<a name="l01373"></a>01373 
<a name="l01374"></a>01374 
<a name="l01375"></a>01375 
<a name="l01376"></a>01376 
<a name="l01378"></a>01378 
<a name="l01385"></a>01385 <span class="comment">// TODO: implement a fast version using lookup-tables of size 8</span>
<a name="l01386"></a><a class="code" href="namespacesdsl_1_1algorithm.html#a88e65161b14a1a12aebeddc9cf0300f2">01386</a> <span class="keyword">inline</span> bit_vector::size_type <a class="code" href="namespacesdsl_1_1algorithm.html#a88e65161b14a1a12aebeddc9cf0300f2" title="Find the opening parenthesis of the enclosing pair if this parenthesis is near.">near_enclose</a>(<span class="keyword">const</span> bit_vector &amp;bp, bit_vector::size_type i, <span class="keyword">const</span> bit_vector::size_type block_size){
<a name="l01387"></a>01387         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01388"></a>01388         size_type opening_parentheses = 1;
<a name="l01389"></a>01389         <span class="keywordflow">for</span>(size_type j=i; j+block_size-1 &gt; i and j&gt;0; --j){
<a name="l01390"></a>01390                 <span class="keywordflow">if</span>(bp[j-1]){
<a name="l01391"></a>01391                         ++opening_parentheses;
<a name="l01392"></a>01392                         <span class="keywordflow">if</span>( opening_parentheses == 2 ){
<a name="l01393"></a>01393                                 <span class="keywordflow">return</span> j-1;
<a name="l01394"></a>01394                         }
<a name="l01395"></a>01395                 }
<a name="l01396"></a>01396                 <span class="keywordflow">else</span>
<a name="l01397"></a>01397                         --opening_parentheses;
<a name="l01398"></a>01398         }
<a name="l01399"></a>01399         <span class="keywordflow">return</span> i;
<a name="l01400"></a>01400 }
<a name="l01401"></a>01401 
<a name="l01402"></a>01402 
<a name="l01403"></a>01403 <span class="keyword">const</span> uint16_t min_excess_info_8bits_lookup[256]={
<a name="l01404"></a>01404 17,4105,4360,8201,4615,8713,8456,12297,4870,8968,8968,12297,8711,12809,12552,16393,
<a name="l01405"></a>01405 5125,9223,9223,13321,9223,13321,12552,16393,8966,13064,13064,16393,12807,16905,16648,20489,
<a name="l01406"></a>01406 5380,9478,9478,13576,9478,13576,13576,16393,9478,13576,13576,16393,12807,16905,16648,20489,
<a name="l01407"></a>01407 9221,13319,13319,17417,13319,17417,16648,20489,13062,17160,17160,20489,16903,21001,20744,24585,
<a name="l01408"></a>01408 5635,9733,9733,13831,9733,13831,13831,17929,9733,13831,13831,17929,13831,17929,16648,20489,
<a name="l01409"></a>01409 9733,13831,13831,17929,13831,17929,16648,20489,13062,17160,17160,20489,16903,21001,20744,24585,
<a name="l01410"></a>01410 9476,13574,13574,17672,13574,17672,17672,20489,13574,17672,17672,20489,16903,21001,20744,24585,
<a name="l01411"></a>01411 13317,17415,17415,21513,17415,21513,20744,24585,17158,21256,21256,24585,20999,25097,24840,28681,
<a name="l01412"></a>01412 5890,9988,9988,14086,9988,14086,14086,18184,9988,14086,14086,18184,14086,18184,18184,20489,
<a name="l01413"></a>01413 9988,14086,14086,18184,14086,18184,18184,20489,14086,18184,18184,20489,16903,21001,20744,24585,
<a name="l01414"></a>01414 9988,14086,14086,18184,14086,18184,18184,20489,14086,18184,18184,20489,16903,21001,20744,24585,
<a name="l01415"></a>01415 13317,17415,17415,21513,17415,21513,20744,24585,17158,21256,21256,24585,20999,25097,24840,28681,
<a name="l01416"></a>01416 9731,13829,13829,17927,13829,17927,17927,22025,13829,17927,17927,22025,17927,22025,20744,24585,
<a name="l01417"></a>01417 13829,17927,17927,22025,17927,22025,20744,24585,17158,21256,21256,24585,20999,25097,24840,28681,
<a name="l01418"></a>01418 13572,17670,17670,21768,17670,21768,21768,24585,17670,21768,21768,24585,20999,25097,24840,28681,
<a name="l01419"></a>01419 17413,21511,21511,25609,21511,25609,24840,28681,21254,25352,25352,28681,25095,29193,28936,32777
<a name="l01420"></a>01420 };
<a name="l01421"></a>01421 
<a name="l01422"></a>01422 <span class="keyword">inline</span> bit_vector::size_type near_rmq_open(<span class="keyword">const</span> bit_vector &amp;bp, <span class="keyword">const</span> bit_vector::size_type begin, <span class="keyword">const</span> bit_vector::size_type end){
<a name="l01423"></a>01423         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01424"></a>01424         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l01425"></a>01425         difference_type min_excess = end-begin+1, ex = 0;
<a name="l01426"></a>01426         size_type result = end;
<a name="l01427"></a>01427         
<a name="l01428"></a>01428         <span class="keyword">const</span> size_type l = ((begin+7)/8)*8;
<a name="l01429"></a>01429         <span class="keyword">const</span> size_type r = (end/8)*8;
<a name="l01430"></a>01430 
<a name="l01431"></a>01431         <span class="keywordflow">for</span>(size_type k=begin; k &lt; std::min(end,l); ++k){
<a name="l01432"></a>01432                 <span class="keywordflow">if</span>(bp[k]){
<a name="l01433"></a>01433                         ++ex;
<a name="l01434"></a>01434                         <span class="keywordflow">if</span>( ex &lt;= min_excess ){
<a name="l01435"></a>01435                                 result = k;
<a name="l01436"></a>01436                                 min_excess = ex;
<a name="l01437"></a>01437                         }
<a name="l01438"></a>01438                 }<span class="keywordflow">else</span>{
<a name="l01439"></a>01439                         --ex;
<a name="l01440"></a>01440                 }
<a name="l01441"></a>01441         }
<a name="l01442"></a>01442         <span class="keyword">const</span> uint64_t *b = bp.data();<span class="comment">// + (l&gt;&gt;6);</span>
<a name="l01443"></a>01443         <span class="keywordflow">for</span>(size_type k = l; k &lt; r; k+=8){
<a name="l01444"></a>01444                 uint16_t x = min_excess_info_8bits_lookup[ ((*(b+(k&gt;&gt;6)))&gt;&gt;(k&amp;0x3F))&amp;0xFF ];
<a name="l01445"></a>01445                 int8_t ones = (x&gt;&gt;12);
<a name="l01446"></a>01446                 <span class="keywordflow">if</span>( ones ){
<a name="l01447"></a>01447                         int8_t min_ex = (x&amp;0xFF)-8;
<a name="l01448"></a>01448                         <span class="keywordflow">if</span>( ex+min_ex &lt;= min_excess ){
<a name="l01449"></a>01449                                 result = k + ((x&gt;&gt;8)&amp;0xF);
<a name="l01450"></a>01450                                 min_excess = ex+min_ex;
<a name="l01451"></a>01451                         }       
<a name="l01452"></a>01452                 }       
<a name="l01453"></a>01453                 ex += ((ones&lt;&lt;1)-8);
<a name="l01454"></a>01454         }
<a name="l01455"></a>01455         <span class="keywordflow">for</span>(size_type k=std::max(r,l); k &lt; end; ++k){
<a name="l01456"></a>01456                 <span class="keywordflow">if</span>(bp[k]){
<a name="l01457"></a>01457                         ++ex;
<a name="l01458"></a>01458                         <span class="keywordflow">if</span>( ex &lt;= min_excess ){
<a name="l01459"></a>01459                                 result = k;
<a name="l01460"></a>01460                                 min_excess = ex;
<a name="l01461"></a>01461                         }
<a name="l01462"></a>01462                 }<span class="keywordflow">else</span>{
<a name="l01463"></a>01463                         --ex;
<a name="l01464"></a>01464                 }
<a name="l01465"></a>01465         }
<a name="l01466"></a>01466         <span class="keywordflow">if</span>( min_excess &lt;= ex )
<a name="l01467"></a>01467                 <span class="keywordflow">return</span> result;
<a name="l01468"></a>01468         <span class="keywordflow">return</span> end;
<a name="l01469"></a>01469 }
<a name="l01470"></a>01470 
<a name="l01471"></a>01471 <span class="keyword">inline</span> bit_vector::size_type near_rmq_open_naive(<span class="keyword">const</span> bit_vector &amp;bp, <span class="keyword">const</span> bit_vector::size_type begin, <span class="keyword">const</span> bit_vector::size_type end){
<a name="l01472"></a>01472         <span class="keyword">typedef</span> bit_vector::size_type size_type;
<a name="l01473"></a>01473         <span class="keyword">typedef</span> bit_vector::difference_type difference_type;
<a name="l01474"></a>01474         difference_type min_excess = end-begin+1, ex = 0;
<a name="l01475"></a>01475         size_type result = end;
<a name="l01476"></a>01476         <span class="keywordflow">for</span>(size_type k=begin; k&lt;end; ++k){
<a name="l01477"></a>01477                 <span class="keywordflow">if</span>(bp[k]){
<a name="l01478"></a>01478                         ++ex;
<a name="l01479"></a>01479                         <span class="keywordflow">if</span>( ex &lt;= min_excess ){
<a name="l01480"></a>01480                                 result = k;
<a name="l01481"></a>01481                                 min_excess = ex;
<a name="l01482"></a>01482                         }
<a name="l01483"></a>01483                 }<span class="keywordflow">else</span>{
<a name="l01484"></a>01484                         --ex;
<a name="l01485"></a>01485                 }
<a name="l01486"></a>01486         }
<a name="l01487"></a>01487         <span class="keywordflow">if</span>( min_excess &lt;= ex )
<a name="l01488"></a>01488                 <span class="keywordflow">return</span> result;
<a name="l01489"></a>01489         <span class="keywordflow">return</span> end;
<a name="l01490"></a>01490 }
<a name="l01491"></a>01491 
<a name="l01492"></a>01492 
<a name="l01493"></a>01493 }<span class="comment">// end namespace algorithm</span>
<a name="l01494"></a>01494 
<a name="l01495"></a>01495 }<span class="comment">// end namespace sdsl</span>
<a name="l01496"></a>01496 
<a name="l01497"></a>01497 <span class="preprocessor">#endif</span>
<a name="l01498"></a>01498 <span class="preprocessor"></span>
<a name="l01499"></a>01499 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 30 2012 16:04:32 for Succinct Data Structure Library (sdsl) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
